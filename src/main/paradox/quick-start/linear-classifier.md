# Linear Classifier

Mandolin implements linear classifiers as a special case of a Generalized Layered Perceptron. 
See the [documentation](../user-guide/mandolin-glp.html) describing the general form of such models. This section
provides some very specific documentation and examples focused on training and applying 
simple linear classifiers. Additionally, the documentation here focuses on training such
models **without spark** as this is sufficient for many modest or even large datasets, given that
linear models are relatively easy to train.

## Mandolin Configuration

As explained elsewhere, Mandolin uses the Typesafe configuration system (used by Akka and Spark among
other programs), see [configuration](../user-guide/configuration.html). This allows for experimental settings to 
be recorded in a single file for later use
and greatly aids replicability.  However, for quick experimentation it helps to be able
to use simple command-line invocations for all program parameters.

## Training a Model

To train a model with a file `training.file` that follows the Mandolin input format, a variety or parameters
must be specified to indicate how the training process should proceed. Additionally, the inventory of
classes or *labels* must be specified within a separate file. Consider the simple example file
in `examples/mllib/sample_multiclass_classification_data.txt`. The labels for this dataset are simply
the integers `1,2` and `3` as specified in the file `examples/mllib/multiclass.labels`, each distinct
label on a separate line.  Given these two files, Mandolin can be used to train a model with:

    java -cp mandolin-assembly-...jar org.mitre.mandolin.app.Driver \
      mandolin.trainer.train-file=examples/mllib/sample_multiclass_classification_data.txt \
      mandolin.trainer.label-file=examples/mllib/multiclass.labels \
      mandolin.without-spark=true \
      mandolin.trainer.model-file=model.file.1 \
      mandolin.mode=train

## Decoding with a Trained Model

A trained model can be used on new data in the same input format as the training data as below. Note
that the input file is specified via the `mandolin.trainer.test-file` option.

    java -cp mandolin-assembly-...jar org.mitre.mandolin.app.Driver \
      mandolin.trainer.test-file=examples/mllib/sample_multiclass_classification_data.txt \
      mandolin.without-spark=true \
      mandolin.trainer.model-file=model.file.1 \
      mandolin.mode=decode \
      mandolin.decoder.output-file=output.predictions

The output file holding the predictions will have columns: `ID`,`<label_1>`,`<label_2>`,...,`Label`
where each `<label_i>` is one of the labels in the provided label file (not necessarily in the same
order).  The final column `Label` is actually the ground truth label in the dataset, if provided.
Each row specifies the posterior distribution over the labels generated by the classifier.

## Evaluation

Model development often proceeds by training a classifier and evaluating it on a held out dataset.
The simplest way to do this in Mandolin is to run in "train-test" mode.  Example invocation:

    java -cp mandolin-assembly-...jar org.mitre.mandolin.app.Driver \
      mandolin.trainer.train-file=examples/mllib/sample_multiclass_classification_data.txt \
      mandolin.trainer.label-file=examples/mllib/multiclass.labels \
      mandolin.trainer.test-file=examples/mllib/sample_multiclass_classification-data.txt \
      mandolin.without-spark=true \
      mandolin.mode=train-test \
      mandolin.trainer.progress-file=training.progress

This will train a model on the data provided with the `mandolin.trainer.train-file` option
and apply the trained model to the test file provided with `mandolin.trainer.test-file`. The model
will be evaluated against the test dataset after each trainign epoch.  To evaluate the model less
frequently, e.g. after every 5 epochs, add the option `mandolin.trainer.eval-freq`, e.g.:

    java -cp mandolin-assembly-...jar org.mitre.mandolin.app.Driver \
      mandolin.trainer.train-file=examples/mllib/sample_multiclass_classification_data.txt \
      mandolin.trainer.label-file=examples/mllib/multiclass.labels \
      mandolin.trainer.test-file=examples/mllib/sample_multiclass_classification-data.txt \
      mandolin.without-spark=true \
      mandolin.mode=train-test \
      mandolin.trainer.progress-file=training.progress \
      mandolin.trainer.eval-freq=5

The output in the `mandolin.trainer.progress-file` value shows the cumulative total training time, the 
training loss, the accuracy on the test data, the area under the ROC (for binary and for multiclass datasets).
In addition, accuracies are computed for subsets (50% and 30%) of the test data based on the entropy of the posterior
distribution provided by the model. Lower entropy posteriors indicate a higher degree of certainty by the model.


## Advanced Options

More advanced options for training models are explained in the User's Guide, including different
online learning algorithms/updaters or using a non-linear model in the form a multilayer perceptron.